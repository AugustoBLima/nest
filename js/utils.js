console.log('imported utils.js');

function newPixelmap( width = 400, height = width, rgb = true, random = true ) {

	var pixelmap = [];
	for (var w = 0; w < width; w++) {
		pixelmap[w] = [];
		for (var h = 0; h < height; h++) {
			let n = 250;
			if ( random ) {
				n = Math.random() * 255;
			}	else if( w % 10 == 0 || h % 10 == 0 ) {
				n = 240;
			}
			pixelmap[w][h] = rgb ? [n, n, n, 0] : n;
		}
	}
	pixelmap.rgb = rgb;
	pixelmap.width = width;
	pixelmap.height = height;

	pixelmap.set = function(x, y, value) {
		if ( y < 0 || x+1 >= this.width || y+1 >= this.height ) {
			//console.log(x, y);
			return; //console.log('pixelmap boundary exceeded');
		}
		//this[ Math.round(x) ][ Math.round(y) ] = value;
		this[ x ][ y ] = value;
		return true;
	}

	pixelmap.mirror = function(){

		let mirrored = [];

		for (var x = 0; x < this.width; x++) mirrored[x] = this[ this.width - x - 1 ];

		mirrored = mirrored.concat( this );

		return mirrored;
	}

	return pixelmap;
}



function point (_x, _y = _x) {
	return [ Math.round(_x), Math.round(_y) ];
}

function normalize ( arr, n = 1 ) {
	let ratio = n / Math.max.apply(Math, arr)
	for (var i = 0; i < arr.length; i++) {
		arr[i] = arr[i] * ratio;
	}
	return arr;
}

function errr( message, obj ) {
	console.log( '%c ' + message + ' ', 'background: #6282d9; color: #0b0236' );
	if ( obj != undefined ) console.log( obj, 'background: #6282d9; color: #0b0236' );
	return false;
}

function attenuate( value, power = 2, numeric = 10 ) {
	return ( value ** power ) / ( (numeric - 1) ** (power - 1) );
}

// 18 rows
var palette = [[[93,9,18],[111,11,21],[130,13,25],[149,15,28],[167,17,32],[186,18,35],[204,20,39],[223,22,42],[233,32,52],[235,51,69],[237,69,86],[238,88,103],[240,106,120],[242,125,137],[244,144,154],[246,162,171],[248,181,187],[249,199,204],[251,218,221]],[[93,18,9],[111,21,11],[130,25,13],[149,28,15],[167,32,17],[186,35,18],[204,39,20],[223,42,22],[233,52,32],[235,69,51],[237,86,69],[238,103,88],[240,120,106],[242,137,125],[244,154,144],[246,171,162],[248,187,181],[249,204,199],[251,221,218]],[[93,31,9],[111,38,11],[130,44,13],[149,50,15],[167,57,17],[186,63,18],[204,69,20],[223,76,22],[233,86,32],[235,100,51],[237,114,69],[238,128,88],[240,142,106],[242,156,125],[244,170,144],[246,184,162],[248,199,181],[249,213,199],[251,227,218]],[[93,54,9],[111,65,11],[130,75,13],[149,86,15],[167,97,17],[186,108,18],[204,118,20],[223,129,22],[233,139,32],[235,149,51],[237,159,69],[238,168,88],[240,178,106],[242,188,125],[244,197,144],[246,207,162],[248,216,181],[249,226,199],[251,236,218]],[[93,65,9],[111,78,11],[130,91,13],[149,104,15],[167,117,17],[186,130,18],[204,143,20],[223,156,22],[233,166,32],[235,173,51],[237,181,69],[238,188,88],[240,196,106],[242,203,125],[244,211,144],[246,218,162],[248,225,181],[249,233,199],[251,240,218]],[[93,76,9],[111,91,11],[130,107,13],[149,122,15],[167,137,17],[186,152,18],[204,167,20],[223,183,22],[233,193,32],[235,198,51],[237,203,69],[238,208,88],[240,214,106],[242,219,125],[244,224,144],[246,229,162],[248,234,181],[249,239,199],[251,245,218]],[[71,93,9],[85,111,11],[99,130,13],[113,149,15],[127,167,17],[141,186,18],[155,204,20],[169,223,22],[179,233,32],[186,235,51],[192,237,69],[198,238,88],[205,240,106],[211,242,125],[217,244,144],[224,246,162],[230,248,181],[236,249,199],[242,251,218]],[[45,93,9],[55,111,11],[64,130,13],[73,149,15],[82,167,17],[91,186,18],[100,204,20],[109,223,22],[119,233,32],[131,235,51],[142,237,69],[153,238,88],[164,240,106],[176,242,125],[187,244,144],[198,246,162],[210,248,181],[221,249,199],[232,251,218]],[[9,93,34],[11,111,41],[13,130,48],[15,149,55],[17,167,62],[18,186,69],[20,204,75],[22,223,82],[32,233,92],[51,235,106],[69,237,120],[88,238,133],[106,240,147],[125,242,160],[144,244,174],[162,246,187],[181,248,201],[199,249,214],[218,251,228]],[[9,93,87],[11,111,105],[13,130,122],[15,149,140],[17,167,157],[18,186,174],[20,204,192],[22,223,209],[32,233,220],[51,235,223],[69,237,225],[88,238,228],[106,240,231],[125,242,234],[144,244,237],[162,246,240],[181,248,243],[199,249,246],[218,251,249]],[[9,86,93],[11,103,111],[13,120,130],[15,137,149],[17,155,167],[18,172,186],[20,189,204],[22,206,223],[32,216,233],[51,219,235],[69,223,237],[88,226,238],[106,229,240],[125,232,242],[144,236,244],[162,239,246],[181,242,248],[199,245,249],[218,249,251]],[[9,73,93],[11,88,111],[13,103,130],[15,117,149],[17,132,167],[18,147,186],[20,161,204],[22,176,223],[32,186,233],[51,192,235],[69,198,237],[88,203,238],[106,209,240],[125,215,242],[144,221,244],[162,226,246],[181,232,248],[199,238,249],[218,244,251]],[[9,40,93],[11,48,111],[13,56,130],[15,64,149],[17,72,167],[18,80,186],[20,88,204],[22,96,223],[32,106,233],[51,118,235],[69,131,237],[88,143,238],[106,156,240],[125,168,242],[144,180,244],[162,193,246],[181,205,248],[199,218,249],[218,230,251]],[[9,26,93],[11,31,111],[13,36,130],[15,41,149],[17,47,167],[18,52,186],[20,57,204],[22,62,223],[32,72,233],[51,88,235],[69,103,237],[88,118,238],[106,133,240],[125,148,242],[144,164,244],[162,179,246],[181,194,248],[199,209,249],[218,225,251]],[[9,12,93],[11,14,111],[13,17,130],[15,19,149],[17,22,167],[18,24,186],[20,26,204],[22,29,223],[32,39,233],[51,57,235],[69,75,237],[88,93,238],[106,111,240],[125,129,242],[144,147,244],[162,165,246],[181,183,248],[199,201,249],[218,219,251]],[[43,9,93],[51,11,111],[60,13,130],[68,15,149],[77,17,167],[85,18,186],[94,20,204],[102,22,223],[113,32,233],[124,51,235],[136,69,237],[148,88,238],[160,106,240],[172,125,242],[184,144,244],[196,162,246],[208,181,248],[219,199,249],[231,218,251]],[[65,9,93],[78,11,111],[91,13,130],[104,15,149],[117,17,167],[130,18,186],[143,20,204],[156,22,223],[166,32,233],[173,51,235],[181,69,237],[188,88,238],[196,106,240],[203,125,242],[211,144,244],[218,162,246],[225,181,248],[233,199,249],[240,218,251]],[[87,9,93],[105,11,111],[122,13,130],[140,15,149],[157,17,167],[174,18,186],[192,20,204],[209,22,223],[220,32,233],[223,51,235],[225,69,237],[228,88,238],[231,106,240],[234,125,242],[237,144,244],[240,162,246],[243,181,248],[246,199,249],[249,218,251]]];